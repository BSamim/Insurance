(function(){'use strict';function onReady(){activateAccordions();activateNavs();activateScrollTriggers();addBodyClasses();}
async function activateAccordions(){var accordions=Array.prototype.slice.call(document.querySelectorAll('.accordion'),0);if(accordions.length>0){accordions.forEach(function(accordion){var accordionHeaders=accordion.querySelectorAll('.accordion-heading');for(var i=0;i<accordionHeaders.length;i++){accordionHeaders[i].addEventListener('click',function(event){toggleActiveClass(findAncestor(event.target,'accordion-item'));});}});}}
async function activateNavs(){var navs=Array.prototype.slice.call(document.querySelectorAll('.nav'),0);if(navs.length>0){navs.forEach(function(nav){var navBurger=nav.querySelectorAll('.nav-burger')[0];if(navBurger!==undefined){navBurger.addEventListener('click',function(){var target=document.getElementById(navBurger.dataset.target);toggleActiveClass(navBurger);toggleActiveClass(target);});}
var navDrops=nav.querySelectorAll('.nav-drop');for(var i=0;i<navDrops.length;i++){navDrops[i].addEventListener('click',function(event){toggleActiveClass(event.target);});}});}}
async function activateScrollTriggers(){var triggers=Array.prototype.slice.call(document.querySelectorAll('[data-scroll-trigger]'),0);if(triggers.length>0){var onScroll=function(event,elem){var isPastTarget;var triggerType=elem.dataset.scrollTrigger;var target=document.getElementById(elem.dataset.target);var cssClass=elem.dataset.class;if(triggerType==='above'){isPastTarget=(window.scrollY<(elem.offsetTop+elem.offsetHeight));}
else if(triggerType==='below'){isPastTarget=(window.scrollY>(elem.offsetTop+elem.offsetHeight));}
if(isPastTarget){target.classList.add(cssClass);}
else{target.classList.remove(cssClass);}};triggers.forEach(function(trigger){window.addEventListener('scroll',function(event){onScroll(event,trigger);});});}}
async function addBodyClasses(){if(DeviceHelpers.isIos()){document.body.classList.add('ios');}
if(DeviceHelpers.isSafari()){document.body.classList.add('safari');}
if(DeviceHelpers.isAndroid()){document.body.classList.add('android');}}
function findAncestor(elem,className){while((elem=elem.parentElement)&&!elem.classList.contains(className));return elem;}
function toggleActiveClass(elem){elem.classList.toggle('is-active');}
var tid=setInterval(function(){if(document.readyState!=='complete'){return;}
clearInterval(tid);onReady();},100);function slick_SetPageIndicator(slick,pagesIndicator,page){if(typeof page==='undefined'){var page=(slick.currentSlide/slick.options.slidesToScroll)+1;}
pagesIndicator.find('.column').removeClass('active');pagesIndicator.find('.column:nth-child('+page+')').addClass('active');}
function slick_InitPageIndicators(slick,pagesIndicator){var pageCount=Math.ceil(slick.slideCount/slick.options.slidesToShow);pagesIndicator.empty();for(var i=0;i<pageCount;i++){pagesIndicator.append('<div class="column"></div>');}}
function slick_SetBizChoiceAction(elem){var bizChoices=$(elem).find('.biz-choices');if(bizChoices.length<=0){return;}
$(bizChoices).find('button.biz-line').each(function(i,el){$(el).on('click',function(event){var choice=$(this).attr('data-bizline');var snippet=$(this).closest('[id^="recent-quotes-"]');var mySlick=$(snippet).find('.slick-carousel');$(this).addClass('active');mySlick.slick("unslick");snippet.find('.slick-carousel').remove();var $content=snippet.find('.content');snippet.find('.data .recent-quotes-'+choice).clone().appendTo($content).addClass('slick-carousel');slick_InitialzeSlickCarousel(elem);$(this).siblings('button').removeClass('active');});});}
function slick_InitialzeSlickCarousel(elem){var mySlick=$(elem).find('.slick-carousel');var pagesIndicator=$(elem).find('.pages-indicator');mySlick.on('init',function(event,slick){slick_InitPageIndicators(slick,pagesIndicator);slick_SetPageIndicator(slick,pagesIndicator);});mySlick.on('beforeChange',function(event,slick,currentSlide,nextSlide){var page=(nextSlide/slick.options.slidesToScroll)+1;slick_SetPageIndicator(slick,pagesIndicator,page);});mySlick.on('breakpoint',function(event,slick,breakpoint){slick_InitPageIndicators(slick,pagesIndicator)
slick_SetPageIndicator(slick,pagesIndicator);});mySlick.not('.slick-initialized').slick({nextArrow:$(elem).find('.slick-nav button.next'),prevArrow:$(elem).find('.slick-nav button.prev'),});$(elem).find('.slick-slide').each(function(){var $slide=$(this);if($slide.attr('aria-describedby')!==undefined&&$slide.attr('id')===undefined){$(this).attr('id',$slide.attr('aria-describedby'));}});}
$('[id^="recent-quotes-"]').each(function(i,e){slick_InitialzeSlickCarousel(e);slick_SetBizChoiceAction(e);});$('[id^="customer-reviews-"]').each(function(i,e){slick_InitialzeSlickCarousel(e);});})();var Common={PostalRegex:{'CA':/^[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ]( )?\d[ABCEGHJKLMNPRSTVWXYZ]\d( )?$/i,'US':/^\d{5}(-\d{4})?$/,'QC':/^([GHJ])/i,'NT':/^([X])/i,'YK':/^([Y])/i,}};Common.IsValid={PostalCode:function(str,iso){var myregex=Common.PostalRegex[iso.toUpperCase()];var match=myregex.test(str);if(match){return true;}
return false;},EmailAddress:function(str){return /^([\w\-]+\.)*[\w\-]+\@([\w\-]+\.)+([A-Za-z]{2,4})$/.test(str);}};Common.GetProviceID=function(provinceCode){var code='';if(provinceCode!=null)
code=provinceCode.toUpperCase();switch(code)
{case 'NL':return 1073;case 'NS':return 5313;case 'PE':return 3207;case 'NB':return 5876;case 'QC':return 3259;case 'ON':return 1985;case 'MB':return 1530;case 'SK':return 4571;case 'AB':return 1;case 'BC':return 623;case 'YT':return 7558;case 'NT':return 5255;default:return null;}};Common.GetProvince=function(postalCode){var char='';if(postalCode[0]!=null)
char=postalCode[0].toUpperCase();switch(char){case 'A':return 'NL';case 'B':return 'NS';case 'C':return 'PE';case 'E':return 'NB';case 'G':case 'H':case 'J':return 'QC';case 'K':case 'L':case 'M':case 'N':case 'P':return 'ON';case 'R':return 'MB';case 'S':return 'SK';case 'T':return 'AB';case 'V':return 'BC';case 'X':case 'Y':return 'YT';default:return null;}};Common.GetBusinessLineId=function(businessLine){switch(businessLine){case 'auto':return 1;case 'life':return 2;case 'home':return 3;case 'motorcycle':return 4;case 'commercial':return 5;case 'travel':return 6;case 'travel_vtc':return 6;case 'travel_students':return 6;default:return null;}};Common.GetBusinessLine=function(businessLine){switch(businessLine){case '1':return 'auto';case '2':return 'life';case '3':return 'home';case '4':return 'motorcycle';case '5':return 'commercial';case '6':return 'travel';default:return null;}};var AreCookiesEnabled=function(){var cookieEnabled=(navigator.cookieEnabled)?true:false;if(typeof navigator.cookieEnabled=="undefined"&&!cookieEnabled){document.cookie="testcookie";cookieEnabled=(document.cookie.indexOf("testcookie")!=-1)?true:false;}
return(cookieEnabled);};var SetCookieExpireInHours=function(name,value,hours,domain){var days=hours/24;SetCookie(name,value,days,domain);};var SetCookie=function(name,value,days,domain){var valueToken=name+'='+value+'; ';var expiresToken='; ';if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expiresToken='expires='+date.toGMTString()+'; ';}
var domainToken=domain!==undefined?'Domain='+domain+'; ':'';var sameSiteToken='SameSite=Lax; '
document.cookie=valueToken+expiresToken+domainToken+sameSiteToken+'path=/';};var GetCookie=function(cName){var cValue=document.cookie;var cStart=cValue.indexOf(" "+cName+"=");if(cStart==-1){cStart=cValue.indexOf(cName+"=");}
if(cStart==-1){cValue=null;}else{cStart=cValue.indexOf("=",cStart)+1;var cEnd=cValue.indexOf(";",cStart);if(cEnd==-1){cEnd=cValue.length;}
cValue=unescape(cValue.substring(cStart,cEnd));}
return cValue;};var DeleteCookie=function(name,domain){var valueToken=name+'=; ';var expiresToken='expires=Thu, 01 Jan 1970 00:00:01 GMT; ';var domainToken=domain!==undefined?'Domain='+domain+'; ':'';var sameSiteToken='SameSite=Lax; '
document.cookie=valueToken+expiresToken+domainToken+sameSiteToken+'path=/';};var IsEmptyObject=function(obj){for(var prop in obj){if(Object.prototype.hasOwnProperty.call(obj,prop)){return false;}}
return true;};var GetKxGid=function(my_ga){var cookie_name='_kx_gid';var value=GetCookie(cookie_name);var pattern=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;if(!value||!value.match(pattern)){jQuery.ajax({url:'/Api/Utility/NewGuid',type:'GET',async:true,success:function(data){value=data.value;my_ga('set','kx_gid',value);SetCookie(cookie_name,value,(365*2),'.insurancehotline.com')},error:function(){},complete:function(){}});}
if(value&&value.match(pattern)){SetCookie(cookie_name,value,(365*2),'.insurancehotline.com')}
return value;};var SubscribeRenewalAndNewsletter=function(elem){var endpoint="/WebServices/SubscribeService.asmx/AddRenewalNewsletter";var payload='{"renewalNewsletterRequestDto":{"EmailAddress":"bobby@here.ca","BusinessLine":"1","RenewalDateMonth":"3"}}';var responseMessage=function(msg,form){$(elem).find('div.response').html(msg);};var requestObj=new Object();requestObj.EmailAddress=$(elem).find("[name='emailAddress']").val();requestObj.BusinessLine=$(elem).find("[name='businessLine']").val();requestObj.RenewalDateMonth=$(elem).find("[name='renewalDateMonth']").val();$(elem).find('button[type="submit"]').attr('disabled',true);var hostname=(window.location.href.indexOf('localhost')!=-1)?'https://qa.insurancehotline.com':'';var myData=JSON.stringify({renewalNewsletterRequestDto:requestObj});$.ajax({url:hostname+'/WebServices/SubscribeService.asmx/AddRenewalNewsletter',type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",crossOrigin:true,data:myData,success:function(data,textStatus,errorThrown){var msg='Thank you. Your information has been saved successfully.';if(data.d.ResponseCode!="OK"){msg='ERROR: '+data.d.ErrorMessages[0];}
responseMessage(msg,elem);},error:function(jqXHR,textStatus,errorThrown){var msg='Looks like there is an error somewhere.  Please refresh the page and try again.';responseMessage(msg,elem);},complete:function(jqXHR,textStatus){$(elem).find('button[type="submit"]').removeAttr('disabled');}});};var IsValidRenewalReminderForm=function(elem){var errors=0;if(typeof elem!=='object'){return;}
var field_email=$(elem).find('input[name="emailAddress"]');field_email.siblings('.error').hide();if(field_email){if(!Common.IsValid.EmailAddress(field_email.val())){errors++;field_email.siblings('.error').show();}}
return(errors==0);};var InitializeRenewalReminderForms=async function(){var myForms=$('form[id^="renewal-reminder-signup-"]');myForms.each(function(i,e){$(this).on('submit',function(e){e.preventDefault();if(IsValidRenewalReminderForm($(this))){SubscribeRenewalAndNewsletter($(this));}});});};var NewsletterSignup=function(elem){var payload='{"mailChimpSubscribeRequestDto":{"EmailAddress":"bobby@here.ca","BusinessLine":"1","RenewalDateMonth":"3"}}';var responseMessage=function(msg,form){$(elem).find('div.response').html(msg);};var requestObj=new Object();requestObj.Email=$(elem).find("[name='email']").val();requestObj.Fname=$(elem).find("[name='first_name']").val();requestObj.Event=$(elem).find("[name='event']").val();requestObj.ProvLname_IgnoreValidation=$(elem).find("[name='ProvLname_IgnoreValidation']").val();requestObj.ClientIp=ClientIp;var hostname=(window.location.href.indexOf('localhost')!=-1)?'https://qa.insurancehotline.com':'';var myData=JSON.stringify({renewalNewsletterRequestDto:requestObj});$.ajax({url:hostname+'/WebServices/SubscribeService.asmx/MailChimpSubscribe',type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",crossOrigin:true,data:myData,success:function(data,textStatus,errorThrown){var msg='Thank you. Your information has been saved successfully.';if(data.d.ResponseCode!="OK"){msg='ERROR: '+data.d.ErrorMessages[0];}
responseMessage(msg,elem);},error:function(jqXHR,textStatus,errorThrown){var msg='Looks like there is an error somewhere.  Please refresh the page and try again.';responseMessage(msg,elem);}});};var IsValidNewsletterForm=function(elem){var errors=0;if(typeof elem!=='object'){return;}
var field_email=$(elem).find('input[name="email"]');field_email.siblings('.error').hide();if(field_email){if(!Common.IsValid.EmailAddress(field_email.val())){errors++;field_email.siblings('.error').show();}}
return(errors==0);};var InitializeNewsletterSignupForms=async function(){var myForms=$('form[class^="newsletter-signup-"]');myForms.each(function(i,e){$(this).on('submit',function(e){e.preventDefault();if(IsValidNewsletterForm($(this))){NewsletterSignup($(this));}});});};var karmaSessionID=guid();var CreateServiceUsageForKarma=function(serviceType,brokerID,businessLine,province){var serviceUsage=new Object();serviceUsage.ServiceType=serviceType;serviceUsage.BrokerId=brokerID;serviceUsage.BusinessLine=Common.GetBusinessLineId(businessLine);serviceUsage.ProvinceId=Common.GetProviceID(province);serviceUsage.Url=window.location.href;serviceUsage.SessionGuid=karmaSessionID;var hostname=(window.location.href.indexOf('localhost')!=-1)?'https://qa.insurancehotline.com':'';$.ajax({url:hostname+'/WebServices/UsageService.asmx/Create',type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",cache:false,data:"{'serviceUsage':"+JSON.stringify(serviceUsage)+"}",success:function(data)
{},error:function(jqXHR,textStatus,errorThrown)
{}});};var karmaInsuranceProcess=function(){var myform=document.getElementById('startQuoteForm');var businessLine=myform.querySelectorAll('[name="businessLine"]')[0].value;if(Common.GetBusinessLine(businessLine)!=='life'){return false;}
if(myform.querySelectorAll('[id="postalCode"]')[0]!=undefined){var postalCode=myform.querySelectorAll('[id="postalCode"]')[0].value;var province=Common.GetProvince(postalCode);}
else{var province=myform.querySelectorAll('[id="provinceCode"]')[0].value;}
if(province!=='QC'){return false;}
var timer=setTimeout(function(){if(typeof ga==="function"){ga('send','event','Transfer modal','Tranfer','Karma Insurance');}
CreateServiceUsageForKarma(4,10372,'life','QC');var utm_source="insurancehotline";if(AppsEnvironment!="live")
utm_source='insurancehotline_test';window.location="https://www.karmainsurance.ca/life-insurance/app?utm_source="+utm_source+"&postal="+postalCode;},5000);Modal.Options.remote_url='/static/ih/modals/modal-karma.html';Modal.Options.on_close=function(){clearTimeout(timer);CreateServiceUsageForKarma(5,10372,"life","QC");if(typeof ga==="function"){ga("send","event","Transfer modal","Close","Karma Insurance");}}
if(typeof ga==="function"){ga("send","event","Transfer modal","Open","Karma Insurance");}
CreateServiceUsageForKarma(3,10372,"life","QC");Modal.Open();return true;};var karma_redirect_button_click=function(){if(typeof ga==="function"){ga("send","event","Transfer modal","CTA","Karma Insurance");ga("send","event","Transfer modal","Tranfer","Karma Insurance");}
CreateServiceUsageForKarma(4,10372,"life","QC");var postalCode=document.getElementById("postalCode").value;var utm_source="insurancehotline";if(AppsEnvironment!="live"){utm_source="insurancehotline_test";}
window.location.href="https://www.karmainsurance.ca/life-insurance/app?utm_source="+utm_source+"&postal="+postalCode;};var ProcessQuebecPostalAuto=function(e){try{var myform=document.getElementById('startQuoteForm');var businessLine=myform.querySelectorAll('[name="businessLine"]')[0].value;var postalCode=myform.querySelectorAll('[id="postalCode"]')[0].value;var province=Common.GetProvince(postalCode);if(Common.GetBusinessLine(businessLine)!=='auto'){return false;}
if(province!=='QC'){return false;}
e.preventDefault();Modal.Options.type='card';Modal.Options.title='Compare Insurance Quotes / Comparez les offres d\'assurance';Modal.Options.buttons=[{name:'ok',class:'btn-ok',copy:'Continue / continuer',on_click:function(){var lang=$('#language-chooser form input[name="cultureCode"]:checked').val();var postal_code=$('#startQuoteForm input[name="postalCode"]').val();RedirectAutoQuebec(lang,postal_code);}}]
Modal.Options.remote_url='/static/ih/modals/modal-language.html';Modal.Open();}catch(error){console.log('error in ProcessQuebecPostalAuto.  Message: '+error.Message);return false;}};var RedirectAutoQuebec=function(lang,postal_code){var ih_host=(AppsEnvironment=="live")?"https://www.insurancehotline.com":"https://qa.insurancehotline.com";var aa_host=(AppsEnvironment=="live")?"https://www.assistanceassurance.ca":"https://qa.assistanceassurance.ca";if(lang=='fr-CA'){var content_path="/static/ih/modals/modal-redirect-aa-fr.html";var mytimeout=setTimeout(function(){location.href=aa_host+'/Offres/Auto?postalCode='+postal_code+'&lang='+lang;},5000);Modal.Close();Modal.Options.type=null;Modal.Options.remote_url=content_path;Modal.Options.on_close=function(){clearTimeout(mytimeout);};Modal.Open();}else if(lang=='en-CA'){Modal.Close();location.href=ih_host+'/Quote/Auto?postalCode='+postal_code+"&lang=en-CA";}};function guid(){return s4()+s4()+'-'+s4()+'-'+s4()+'-'+s4()+'-'+s4()+s4()+s4();}
function s4(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);}
function getAll(selector){return Array.prototype.slice.call(document.querySelectorAll(selector),0);}
var EuNotificationCheck=async function(){var eunotification=GetCookie("eunotification");if(eunotification==null||eunotification==''){if(ClientIp!=''&&ClientIp!='None'){$.ajax({url:'/ajax/is_ip_from_eu',data:{'ip':ClientIp},dataType:'json',success:function(data){if(data.is_eu==true){$("#eu-notification").css("display",'block');document.cookie="eunotification=true; SameSite=Lax; path=/;";}
else{document.cookie="eunotification=false; SameSite=Lax; path=/;";}},error:function(jqXHR,textStatus,errorThrown)
{}});}}
if(eunotification=='true'){$("#eu-notification").css("display","block");}};var GetSegID=function(){var cookie_name='segID';var value=GetCookie(cookie_name);if(value)
{value=value.replace("segID=","");if(!value)
{value="0";}}
else
{value="0";}
return value;};var loadImageViaData=function(elem){if(elem.hasAttribute('data-bgload')){var new_style='background-image:url('+elem.getAttribute('data-bgload')+');';var cur_style=elem.getAttribute('style');if(cur_style){new_style=cur_style+' '+new_style;}
elem.setAttribute('style',new_style);elem.removeAttribute("data-bgload");}
if(elem.hasAttribute('data-src')){var newUrl=elem.getAttribute('data-src');elem.setAttribute('src',newUrl);elem.removeAttribute("data-src");}};if('IntersectionObserver'in window){var intersectionObserver=new IntersectionObserver(function(entries){for(let i=0;i<entries.length;i++){let entry=entries[i];if(entry.intersectionRatio<=0)continue;loadImageViaData(entry.target);}});}
var initializeLoadImagesInView=function(hasIntersectionObserver){var selectors=['[data-src]','[data-bgload]'];for(let s=0;s<selectors.length;s++){var elems=document.querySelectorAll(selectors[s]);for(let i=0;i<elems.length;i++){if(hasIntersectionObserver){intersectionObserver.observe(elems[i]);}else{loadImageViaData(elems[i]);}}}};var initializeImageLoading=async function(){var hasIntersectionObserver=('IntersectionObserver'in window);initializeLoadImagesInView(hasIntersectionObserver);};var initializeDynamicLineGraphs=async function(){var canvases=document.querySelectorAll('.graph-container>.chart>canvas');for(var canvasIndex=0;canvasIndex<canvases.length;canvasIndex++){var canvas=canvases[canvasIndex];var ctx=canvas.getContext('2d');var chartData=JSON.parse(canvas.getAttribute('data'));var x_data=chartData['x'].split(',');var data=chartData['data'];var datasets=[]
for(var idx=0;idx<data.length;idx++){var chart_data={label:data[idx].value.legend_text,data:data[idx].value.y_data.split(','),fill:false,backgroundColor:data[idx].value.colour,borderColor:data[idx].value.colour};datasets.push(chart_data);}
var options={maintainAspectRatio:false,elements:{line:{tension:0}},legend:{align:'start',padding:20,labels:{fontStyle:'bold'}},scaleLabel:{fontStyle:'bold'},scales:{xAxes:[{ticks:{autoSkip:false,maxRotation:90,minRotation:90,suggestedMin:4,suggestedMax:4,maxTicksLimit:4,min:0,max:4},gridLines:{display:false}}],yAxes:[{ticks:{fontStyle:'bold',padding:10}}]},plugins:{zoom:{pan:{enabled:true,mode:'x'},zoom:{enabled:true,mode:'x'}}},tooltips:{callbacks:{title:function(tooltipItem,data){return tooltipItem.value;},label:function(tooltipItem,data){return tooltipItem.value;}},backgroundColor:'#FFF',bodyFontColor:'#000',borderColor:'#000',borderWidth:1,xPadding:16,yPadding:16}};Chart.Legend.prototype.afterFit=function(){this.height=this.height+24;};var myChart=new Chart(ctx,{type:'line',data:{labels:x_data,datasets:datasets},options:options});if(window.innerWidth<768&&x_data.length>10){var e=document.createEvent('MouseEvents')
e.initEvent('wheel',true,true)
e.deltaY=-10e20;setTimeout(()=>{for(let i=0;i<x_data.length*3;i++)
canvas.dispatchEvent(e);},500);}}
initializeDynamicGraphInfoLabels();}
var initializeDynamicGraphInfoLabels=async function(){var graphContainers=document.querySelectorAll('.graph-container');for(var graphsIdx=0;graphsIdx<graphContainers.length;graphsIdx++){var graphInfoLabels=graphContainers[graphsIdx].querySelectorAll('.graph-container>.graph-info .graph-info-label');var mobileWidth=769;if(graphInfoLabels.length>0){var found=0;for(var i=0;i<graphInfoLabels.length;i++){var text=graphInfoLabels[i].getAttribute('value');if(window.innerWidth>mobileWidth){graphInfoLabels[i].innerHTML=text.replace('\\n','<br/>');if(text.indexOf('\\n')>-1)
found=1;}
else{graphInfoLabels[i].innerText=text.replace('\\n',' ');}}
if(found>0&&window.innerWidth>mobileWidth)
graphInfoLabels[0].style.lineHeight=3;else
graphInfoLabels[0].style.lineHeight=1;}}}
var handleCOVIDNewsletterSubmit=async function(elem){var responseMessage=function(msg,elem){elem.querySelector("#response-message").innerHTML=msg;};var requestObj=new Object();requestObj.province=elem.querySelector("[name='province']").value;requestObj.email_address=elem.querySelector("[name='email_address']").value;requestObj.usage=elem.querySelector("[name='usage']").value;requestObj.provider=elem.querySelector("[name='provider']").value;$.ajax({url:"/wtajax/subscribe_to_covid_newsletter",type:"GET",contentType:"application/json; charset=utf-8",dataType:"json",data:requestObj,beforeSend:function(xhr,settings){elem.querySelector('button[type="submit"]').setAttribute("disabled","true");},success:function(data,textStatus,errorThrown){var msg='';if(typeof data!=='undefined'){if(typeof data.error_message!=='undefined'){msg=data.error_message;}
if(typeof data.success!=='undefined'){msg='Thank you.';}}else{msg='ERROR: data object is undefined';}
responseMessage(msg,elem);},error:function(jqXHR,textStatus,errorThrown){var msg='Oops, something went wrong :( Please try again.';responseMessage(msg,elem);}})}
var initCOVIDNewsletterForms=async function(){var forms=Array.prototype.slice.call(document.querySelectorAll('.covid-calculator-result form'),0);if(forms.length>0){forms.forEach(function(form){form.addEventListener('submit',function(event){event.preventDefault();handleCOVIDNewsletterSubmit(form);},true);});}}
var handleCOVIDCalculatorSubmit=function(ele){var requestObj=new Object();requestObj.provider=ele.querySelector("[name='provider']").value;;requestObj.province=ele.querySelector("[name='province']").value;;requestObj.id=ele.querySelector("[name='id']").value;requestObj.usage=ele.querySelector("[name='usage']").value;requestObj.premium=ele.querySelector("[name='premium']").value;$.ajax({url:'/wtajax/covid_calculator',type:'GET',data:requestObj,beforeSend:function(xhr,settings){var savingsBlock=document.querySelector(".snippet-covid_calculator_snippet .savings");savingsBlock.style.display="none";var conditionBlock=document.querySelector(".snippet-covid_calculator_snippet .conditions");conditionBlock.style.display="none";},success:function(response){var savingsBlock=document.querySelector(".snippet-covid_calculator_snippet .savings");if(response.savings!=0){savingsBlock.style.display="flex";savingsBlock.querySelector("#savings").innerHTML="$"+response.savings;}
var conditionBlock=document.querySelector(".snippet-covid_calculator_snippet .conditions");conditionBlock.style.display="flex";conditionBlock.innerHTML=response.conditions;var newsletterBlock=document.querySelector(".snippet-covid_calculator_snippet .newsletter-signup");newsletterBlock.style.display="flex";newsletterBlock.querySelector("#province").value=response.province;newsletterBlock.querySelector("#provider").value=response.provider;newsletterBlock.querySelector("#usage").value=response.usage;savingsBlock.scrollIntoView();}});}
var initCOVIDCalculatorForms=async function(){var forms=Array.prototype.slice.call(document.querySelectorAll('.covid-calculator-form form'),0);if(forms.length>0){forms.forEach(function(form){form.addEventListener('submit',function(event){event.preventDefault();handleCOVIDCalculatorSubmit(form);},true);});}}
var sonnetInsuranceProcess=function(id){var myform=document.getElementById(id);var businessLine=myform.querySelectorAll('[name="businessLine"]')[0].value;if(myform.querySelectorAll('[id="postalCode"]')[0]!=undefined){var postalCode=myform.querySelectorAll('[id="postalCode"]')[0].value;var province=Common.GetProvince(postalCode);}
else{var province=myform.querySelectorAll('[id="provinceCode"]')[0].value;}
if(Common.GetBusinessLine(businessLine)!=='auto'){return false;}
if(province!=='QC'){return false;}
Modal.Options.remote_url='/static/ih/modals/modal-sonnet.html';Modal.Options.on_close=function(){if(typeof ga==="function"){ga("send","event","Transfer modal","Close","Sonnet Insurance");}}
if(typeof ga==="function"){ga("send","event","Transfer modal","Open","Sonnet Insurance");}
Modal.Open();return true;};var sonnetEnglishRedirectButtonClick=function(){if(typeof ga==="function"){ga("send","event","Transfer modal","CTA","Sonnet Insurance English");ga("send","event","Transfer modal","Tranfer","Sonnet Insurance English");}
window.location.href="https://secure.sonnet.ca/#/quoting/auto/vehicle_details?lang=en&utm_source=kanetix&utm_campaign=BD_Pro_Auto_QC_EN_Kanetix-Auto";};var sonnetFrenchRedirectButtonClick=function(){if(typeof ga==="function"){ga("send","event","Transfer modal","CTA","Sonnet Insurance French");ga("send","event","Transfer modal","Tranfer","Sonnet Insurance French");}
window.location.href="https://secure.sonnet.ca/#/quoting/auto/vehicle_details?lang=fr&utm_source=kanetix&utm_campaign=BD_Pro_Auto_QC_FR_Kanetix-Auto";};var travelguardianInsuranceProcess=function(){var myform=document.getElementById('startQuoteForm');var businessLine=myform.querySelectorAll('[name="businessLine"]')[0].value;if(myform.querySelectorAll('[id="postalCode"]')[0]!=undefined){var postalCode=myform.querySelectorAll('[id="postalCode"]')[0].value;var province=Common.GetProvince(postalCode);}
else{var province=myform.querySelectorAll('[id="provinceCode"]')[0].value;}
if(Common.GetBusinessLine(businessLine)!=='travel'){return false;}
if(province!=='QC'){return false;}
Modal.Options.remote_url='/static/ih/modals/modal-travelguardian.html';Modal.Options.on_close=function(){if(typeof ga==="function"){ga("send","event","Transfer modal","Close","Travelguardian Insurance");}}
if(typeof ga==="function"){ga("send","event","Transfer modal","Open","Travelguardian Insurance");}
Modal.Open();return true;};var travelguardianEnglishRedirectButtonClick=function(){if(typeof ga==="function"){ga("send","event","Transfer modal","CTA","Travelguardian Insurance English");ga("send","event","Transfer modal","Tranfer","Travelguardian Insurance English");}
window.location.href="https://ratesdotca.travelguardian.ca/en/form-outbound-ratesdotca/ ";};var travelguardianFrenchRedirectButtonClick=function(){if(typeof ga==="function"){ga("send","event","Transfer modal","CTA","Travelguardian Insurance French");ga("send","event","Transfer modal","Tranfer","Travelguardian Insurance French");}
window.location.href="https://ratesdotca.travelguardian.ca/fr/formulaire-sortant-ratesdotca/";};var howToSnippetProvinceChange=function(){let searchParams=[];let searchParamsObj={};var saveQueryParams=(url)=>{const params=Array.from(url.search.slice(1).split('&'))
params.forEach(value=>{searchParams.push(value.split('='))})}
var prv=$(".snippet-how_to_snippet .howtoProvinceSelect select");var postalCode=$('.howtoPostalCode input');var el=null
if(prv.length===1)el=prv
else if(postalCode.length===1)el=postalCode
if(el){el.change(function(){var link=$(".btn-quoter").attr('href');var url=new URL(link);saveQueryParams(url);for(let entry of searchParams){searchParamsObj[entry[0]]=entry[1]}
if(prv.length===1)searchParamsObj.province=el.val()
else if(postalCode.length===1)searchParamsObj.postalCode=el.val().replace(' ','')
query='';count=0;for(let[k,v]of Object.entries(searchParamsObj)){query+=count===0?'?':'&'
query+=`${k}=${v}`
count++}
$(".btn-quoter").attr('href',`${url.origin}${url.pathname}${query}`)})}}
$(document).ready(function(){initializeImageLoading();InitializeRenewalReminderForms();InitializeNewsletterSignupForms();initializeDynamicLineGraphs();initCOVIDCalculatorForms();initCOVIDNewsletterForms();howToSnippetProvinceChange();$(".eu-notification-delete-button").click(function(){$("#eu-notification").css("display","none");document.cookie="eunotification=false; SameSite=Lax; path=/;";});EuNotificationCheck();$('#startQuoteForm').submit(function(e){if(karmaInsuranceProcess()||sonnetInsuranceProcess('startQuoteForm')||travelguardianInsuranceProcess()){return false;}
ProcessQuebecPostalAuto(e);return true;});$('#startQuoteFormSnippet').submit(function(e){if(sonnetInsuranceProcess('startQuoteFormSnippet')){return false;}
ProcessQuebecPostalAuto(e);return true;});$("input").on("click",function(){if($(this).attr("type")==="radio"){$(this).parent().siblings().removeClass("isSelected");}
$(this).parent().toggleClass("isSelected");});$("#go-to-page-form").submit(function(event){let values=$(this).serializeArray();let blogPageSlug=values[0].value;let goToPage=values[1].value;window.location.href='/'+blogPageSlug+'/?page='+goToPage;event.preventDefault();});});